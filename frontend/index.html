<!DOCTYPE html>
<html>
<head>
    <title>MediReminder Test</title>
</head>
<body>
    <h1> Notification Test Page</h1>
    <p>Open Console (F12) to see your Token.</p>
    <button onclick="requestPermission()"> 1. Click to Enable Notifications</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
        import { getMessaging, getToken, onMessage } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-messaging.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC9BD1eVJkmzUL2fgwnBZNT9ufLDq_MiNI",
            authDomain: "medication-reminder-e87a4.firebaseapp.com",
            projectId: "medication-reminder-e87a4",
            storageBucket: "medication-reminder-e87a4.firebasestorage.app",
            messagingSenderId: "520153865045",
            appId: "1:520153865045:web:b23af841554f088c58addc",
            measurementId: "G-HDR04VFTWP"
    };

    const app = initializeApp(firebaseConfig);
    const messaging = getMessaging(app);

    // 1. Get the Token (The Address)
        window.requestPermission = async function() {
            try {
                const permission = await Notification.requestPermission();
                if (permission === 'granted') {
                    // âš ï¸ You need a VAPID Key from Firebase Console -> Cloud Messaging Tab -> Web Configuration
                    const token = await getToken(messaging, {
                        vapidKey: "BEBbHijT6Iggstvg0wYwZ0gmcNTGkdL_SyNYEUofRlldxE6KxsF4vUGtKoGVKh_2RxT8Qu4-_JP8bC_1Rc9-IIg"
                    });
                    console.log("\nCopy this Token and put it in your Database:");
                    console.log(token);
                    alert("Token generated! Check Console (F12)");
                } else {
                    alert("Permission denied!");
                }
            } catch (error) {
                console.error("Error:", error);
            }
        }

        // 2. Listen for messages when tab is OPEN
        onMessage(messaging, (payload) => {
            console.log('Message received. ', payload);
            alert(`ðŸ’Š ${payload.notification.title}\n${payload.notification.body}`);
        });
    </script>
</body>
</html>